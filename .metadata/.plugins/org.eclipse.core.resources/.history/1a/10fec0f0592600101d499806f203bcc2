package com.intense.services;

import javax.jms.Connection;
import javax.jms.ConnectionFactory;
import javax.jms.DeliveryMode;
import javax.jms.Message;
import javax.jms.MessageProducer;
import javax.jms.Queue;
import javax.jms.Session;
import javax.jms.TextMessage;

import com.solacesystems.jms.SolConnectionFactory;
import com.solacesystems.jms.SolJmsUtility;

public class PushSolace {

    public static void main(String[] args) {
        String solaceHost = "tcp://10.255.0.51:55554";
        String solaceVPN = "default";
        String solaceUser = "admin";
        String solacePassword = "admin";
        String queueName = "RJIO_SOLACE_V";

        Connection connection = null;
        Session session = null;
        MessageProducer messageProducer = null;

        try {
            // Create a connection factory using SolJmsUtility
            ConnectionFactory connectionFactory = SolJmsUtility.createConnectionFactory();
            
            // Set the properties on the connection factory
            ((SolConnectionFactory) connectionFactory).setHost(solaceHost);
            ((SolConnectionFactory) connectionFactory).setVPN(solaceVPN);
            ((SolConnectionFactory) connectionFactory).setUsername(solaceUser);
            ((SolConnectionFactory) connectionFactory).setPassword(solacePassword);

            // Establish connection
            connection = connectionFactory.createConnection();
            connection.start();

            // Create a session
            session = connection.createSession(false, Session.CLIENT_ACKNOWLEDGE);

            // Create the queue
            Queue queue = session.createQueue(queueName);
            
            // Create a message producer for the queue
            messageProducer = session.createProducer(queue);

            // Create and send a text message
            TextMessage message = session.createTextMessage("Hello world Queues!");
            messageProducer.send(queue, message, DeliveryMode.PERSISTENT, Message.DEFAULT_PRIORITY, Message.DEFAULT_TIME_TO_LIVE);
            
             
            
            System.out.println("Message sent successfully to the queue: " + queueName);
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            // Close resources
            try {
                if (messageProducer != null) {
                    messageProducer.close();
                }
                if (session != null) {
                    session.close();
                }
                if (connection != null) {
                    connection.close();
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
}
